<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
        integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
        crossorigin="anonymous" />

    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>

    <title>ðŸ”¥Project Create OTP - HTML/SCSS/JavaScriptðŸŒˆ</title>
</head>

<body class="d-flex align-items-center justify-content-center">
    <div class="container-content">
        <div class="mobile-verify go-right active-box">
            <div class="nav d-flex align-items-center justify-content-center">
                <p>Mobile Verification</p>
            </div>
            <div class="text">
                <p>
                    Please enter your mobile <br />number to verify your
                    account
                </p>
                <p>You'll receive a 4 digit code <br />to verify</p>
            </div>
            <div class="phone-num-input">
                <div class="form-input">
                    <label for="phone-number">Enter your phone</label>
                    <input type="text" autocomplete="off" id="phone-number" />
                    <span class="text-danger"></span>
                </div>
            </div>
            <div id="recaptcha-container"></div>
            <button id="btn-continue" class="btn btn-continue">Send OTP</button>
            <div class="keyboard d-flex flex-wrap">
                <span class="num-1 num" data-key="1">1</span>
                <span class="num-2 num" data-key="2">2</span>
                <span class="num-3 num" data-key="3">3</span>
                <span class="num-4 num" data-key="4">4</span>
                <span class="num-5 num" data-key="5">5</span>
                <span class="num-6 num" data-key="6">6</span>
                <span class="num-7 num" data-key="7">7</span>
                <span class="num-8 num" data-key="8">8</span>
                <span class="num-9 num" data-key="9">9</span>
                <span class="num-n num"></span>
                <span class="num-0 num" data-key="0">0</span>
                <span class="remove" data-key="backspace"><i class="fas fa-backspace"></i></span>
            </div>
        </div>
        <div class="otp-container go-right">
            <div class="nav d-flex align-items-center">
                <i class="btn-back fas fa-arrow-left"></i>
                <p>Verification Code</p>
            </div>
            <div class="text">
                <p>
                    Please type the verification <br />
                    code sent to
                    <span class="phone">+8412345***</span>
                </p>
                <p>
                    The OTP will expire in
                    <span class="expire text-dark">30s</span>
                </p>
            </div>
            <div class="otp-input d-flex">
                <input type="text" maxlength="1" class="input" />
                <input type="text" maxlength="1" class="input" />
                <input type="text" maxlength="1" class="input" />
                <input type="text" maxlength="1" class="input" />
            </div>
            <span class="text-danger"></span>
            <button id="btn-verify" class="btn btn-verify d-flex align-items-center justify-content-between">
                Verify now <i class="fas fa-arrow-right"></i>
            </button>
            <div class="resend-code text-muted">
                Didn't receive code?
                <span class="btn-resend text-danger">Request again</span>
            </div>
            <div class="keyboard d-flex flex-wrap">
                <span class="num-1 num" data-key="1">1</span>
                <span class="num-2 num" data-key="2">2</span>
                <span class="num-3 num" data-key="3">3</span>
                <span class="num-4 num" data-key="4">4</span>
                <span class="num-5 num" data-key="5">5</span>
                <span class="num-6 num" data-key="6">6</span>
                <span class="num-7 num" data-key="7">7</span>
                <span class="num-8 num" data-key="8">8</span>
                <span class="num-9 num" data-key="9">9</span>
                <span class="num-n num"></span>
                <span class="num-0 num" data-key="0">0</span>
                <span class="remove" data-key="backspace"><i class="fas fa-backspace"></i></span>
            </div>
        </div>
        <div class="box-verify">
            <i class="fas fa-check-circle"></i>
            <p></p>
        </div>
    </div>
    <!-- 
    <script src="./app.js"></script> -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.4/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.4/firebase-analytics.js";
        import { getAuth, signInWithPhoneNumber } from "https://www.gstatic.com/firebasejs/9.9.4/firebase-auth.js";
    
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDdxO89QLjnPdcR9NOilcXs4qPPGrAld1c",
            authDomain: "django-810fd.firebaseapp.com",
            projectId: "django-810fd",
            storageBucket: "django-810fd.appspot.com",
            messagingSenderId: "907725485940",
            appId: "1:907725485940:web:39c984a826b0950a305e21",
            measurementId: "G-LW2C4843DC"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
    
        const otpContainer = document.querySelector('.otp-container');
        const mobileVerify = document.querySelector('.mobile-verify');
        const boxVerify = document.querySelector('.box-verify');
        const btnContinue = document.querySelector('.btn-continue');
        const btnResend = document.querySelector('.btn-resend');
        const btnVerify = document.querySelector('.btn-verify');
        const btnBack = document.querySelector('.btn-back');
        const phoneNumber = document.getElementById('phone-number');
        const otpInput = document.querySelectorAll('.otp-input .input');
        const containerContent = document.querySelector('.container-content');
        const expireEle = document.querySelector('.expire');
    
        // OTP
        let expire = 30;
        let OTP;
        let countdown;
        let yourInputNumber = '';
    
        btnContinue.addEventListener('click', () => {
            const phonenumber = "+91" + phoneNumber.value;
    
            // Call the Firebase signInWithPhoneNumber method
            signInWithPhoneNumber(auth, phonenumber)
                .then((confirmationResult) => {
                    // SMS sent. Prompt user to type the code from the message, then sign the
                    // user in with confirmationResult.confirm(code).
                    window.confirmationResult = confirmationResult;
                    // ...
                }).catch((error) => {
                    console.log(error, "logerror");
                    // Error; SMS not sent
                    // ...
                });
        });
    
        btnVerify.onclick = function () {
            confirmationResult.confirm(otpInput.value).then(function (response) {
                console.log(response);
                var userobj = response.user;
                var token = userobj.accessToken; // Updated to match Firebase Auth API
                var provider = "phone";
                var email = phoneNumber.value;
                if (token != null && token != undefined && token != "") {
                    sendDatatoServerPhp(email, provider, token, email);
                }
            })
            .catch(function (error) {
                console.log(error);
            });
        }
    </script>
    

</body>


</html>